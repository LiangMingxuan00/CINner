cat('Probability of chromosome-arm missegragation                 = ',prob_CN_chrom_arm_missegregation,'\n')
cat('Probability of focal amplification                           = ',prob_CN_focal_amplification,'\n')
cat('Probability of focal deletion                                = ',prob_CN_focal_deletion,'\n')
cat('Probability of interstitial CN-LOH                           = ',prob_CN_cnloh_interstitial,'\n')
cat('Probability of terminal CN-LOH                               = ',prob_CN_cnloh_terminal,'\n')
cat('Geometric parameter for bin length of a focal amplification  = ',prob_CN_focal_amplification_length,'\n')
cat('Geometric parameter for bin length of a focal deletion       = ',prob_CN_focal_deletion_length,'\n')
cat('Geometric parameter for bin length of an interstitial CN-LOH = ',prob_CN_cnloh_interstitial_length,'\n')
cat('Geometric parameter for bin length of a terminal CN-LOH      = ',prob_CN_cnloh_terminal_length,'\n')
driver_library
driver_library
cat('Poisson rate of new driver mutations                         = ',rate_driver,'\n')
cat('Probability of WGD                                           = ',prob_CN_whole_genome_duplication,'\n')
cat('Probability of chromosome missegragation                     = ',prob_CN_missegregation,'\n')
cat('Probability of chromosome-arm missegragation                 = ',prob_CN_chrom_arm_missegregation,'\n')
cat('Probability of focal amplification                           = ',prob_CN_focal_amplification,'\n')
cat('Probability of focal deletion                                = ',prob_CN_focal_deletion,'\n')
cat('Probability of interstitial CN-LOH                           = ',prob_CN_cnloh_interstitial,'\n')
cat('Probability of terminal CN-LOH                               = ',prob_CN_cnloh_terminal,'\n')
cat('Geometric parameter for bin length of a focal amplification  = ',prob_CN_focal_amplification_length,'\n')
cat('Geometric parameter for bin length of a focal deletion       = ',prob_CN_focal_deletion_length,'\n')
cat('Geometric parameter for bin length of an interstitial CN-LOH = ',prob_CN_cnloh_interstitial_length,'\n')
cat('Geometric parameter for bin length of a terminal CN-LOH      = ',prob_CN_cnloh_terminal_length,'\n')
MODEL <- 'HGSOC-BULK'
SIMULATOR_VARIABLES_for_simulation(MODEL)
cat('Poisson rate of new driver mutations                         = ',rate_driver,'\n')
cat('Probability of WGD                                           = ',prob_CN_whole_genome_duplication,'\n')
cat('Probability of chromosome missegragation                     = ',prob_CN_missegregation,'\n')
cat('Probability of chromosome-arm missegragation                 = ',prob_CN_chrom_arm_missegregation,'\n')
cat('Probability of focal amplification                           = ',prob_CN_focal_amplification,'\n')
cat('Probability of focal deletion                                = ',prob_CN_focal_deletion,'\n')
cat('Probability of interstitial CN-LOH                           = ',prob_CN_cnloh_interstitial,'\n')
cat('Probability of terminal CN-LOH                               = ',prob_CN_cnloh_terminal,'\n')
cat('Geometric parameter for bin length of a focal amplification  = ',prob_CN_focal_amplification_length,'\n')
cat('Geometric parameter for bin length of a focal deletion       = ',prob_CN_focal_deletion_length,'\n')
cat('Geometric parameter for bin length of an interstitial CN-LOH = ',prob_CN_cnloh_interstitial_length,'\n')
cat('Geometric parameter for bin length of a terminal CN-LOH      = ',prob_CN_cnloh_terminal_length,'\n')
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
MODEL <- 'HGSOC-BULK'
SIMULATOR_VARIABLES_for_simulation(MODEL)
cat('Poisson rate of new driver mutations                         = ',rate_driver,'\n')
cat('Probability of WGD                                           = ',prob_CN_whole_genome_duplication,'\n')
cat('Probability of chromosome missegragation                     = ',prob_CN_missegregation,'\n')
cat('Probability of chromosome-arm missegragation                 = ',prob_CN_chrom_arm_missegregation,'\n')
cat('Probability of focal amplification                           = ',prob_CN_focal_amplification,'\n')
cat('Probability of focal deletion                                = ',prob_CN_focal_deletion,'\n')
cat('Probability of interstitial CN-LOH                           = ',prob_CN_cnloh_interstitial,'\n')
cat('Probability of terminal CN-LOH                               = ',prob_CN_cnloh_terminal,'\n')
cat('Geometric parameter for bin length of a focal amplification  = ',prob_CN_focal_amplification_length,'\n')
cat('Geometric parameter for bin length of a focal deletion       = ',prob_CN_focal_deletion_length,'\n')
cat('Geometric parameter for bin length of an interstitial CN-LOH = ',prob_CN_cnloh_interstitial_length,'\n')
cat('Geometric parameter for bin length of a terminal CN-LOH      = ',prob_CN_cnloh_terminal_length,'\n')
driver_library
MODEL <- 'HGSOC-BULK'
SIMULATOR_VARIABLES_for_simulation(MODEL)
cat('Poisson rate of new driver mutations                         = ',rate_driver,'\n')
cat('Probability of WGD                                           = ',prob_CN_whole_genome_duplication,'\n')
cat('Probability of chromosome missegragation                     = ',prob_CN_missegregation,'\n')
cat('Probability of chromosome-arm missegragation                 = ',prob_CN_chrom_arm_missegregation,'\n')
cat('Probability of focal amplification                           = ',prob_CN_focal_amplification,'\n')
cat('Probability of focal deletion                                = ',prob_CN_focal_deletion,'\n')
cat('Probability of interstitial CN-LOH                           = ',prob_CN_cnloh_interstitial,'\n')
cat('Probability of terminal CN-LOH                               = ',prob_CN_cnloh_terminal,'\n')
cat('Geometric parameter for bin length of a focal amplification  = ',prob_CN_focal_amplification_length,'\n')
cat('Geometric parameter for bin length of a focal deletion       = ',prob_CN_focal_deletion_length,'\n')
cat('Geometric parameter for bin length of an interstitial CN-LOH = ',prob_CN_cnloh_interstitial_length,'\n')
cat('Geometric parameter for bin length of a terminal CN-LOH      = ',prob_CN_cnloh_terminal_length,'\n')
driver_library
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
driver_library
unique(driver_library$Affected_donor_count)
unique(driver_library$Chromosome)
vec_selection_rates                 <- rep(0.05,nrow(driver_library))
rate_driver                         <- 1e-16
prob_CN_whole_genome_duplication    <- 1e-6
prob_CN_missegregation              <- 1e-6
prob_CN_chrom_arm_missegregation    <- 1e-6
prob_CN_focal_amplification         <- 1e-6
prob_CN_focal_deletion              <- 1e-6
prob_CN_cnloh_interstitial          <- 1e-6
prob_CN_cnloh_terminal              <- 1e-6
prob_CN_focal_amplification_length  <- 0.1
prob_CN_focal_deletion_length       <- 0.1
prob_CN_cnloh_interstitial_length   <- 0.1
prob_CN_cnloh_terminal_length       <- 0.1
vec_selection_rates                 <- rep(0.05,nrow(driver_library))
rate_driver                         <- 1e-16
prob_CN_whole_genome_duplication    <- 1e-6
prob_CN_missegregation              <- 1e-6
prob_CN_chrom_arm_missegregation    <- 1e-6
prob_CN_focal_amplification         <- 1e-6
prob_CN_focal_deletion              <- 1e-6
prob_CN_cnloh_interstitial          <- 1e-6
prob_CN_cnloh_terminal              <- 1e-6
prob_CN_focal_amplification_length  <- 0.1
prob_CN_focal_deletion_length       <- 0.1
prob_CN_cnloh_interstitial_length   <- 0.1
prob_CN_cnloh_terminal_length       <- 0.1
parameter_set$vec_selection_rates                     <- vec_selection_rates
vec_selection_rates                 <- rep(0.05,nrow(driver_library))
rate_driver                         <- 1e-16
prob_CN_whole_genome_duplication    <- 1e-6
prob_CN_missegregation              <- 1e-6
prob_CN_chrom_arm_missegregation    <- 1e-6
prob_CN_focal_amplification         <- 1e-6
prob_CN_focal_deletion              <- 1e-6
prob_CN_cnloh_interstitial          <- 1e-6
prob_CN_cnloh_terminal              <- 1e-6
prob_CN_focal_amplification_length  <- 0.1
prob_CN_focal_deletion_length       <- 0.1
prob_CN_cnloh_interstitial_length   <- 0.1
prob_CN_cnloh_terminal_length       <- 0.1
parameter_set                                         <- list()
parameter_set$vec_selection_rates                     <- vec_selection_rates
parameter_set$rate_driver                             <- rate_driver
parameter_set$prob_CN_whole_genome_duplication        <- prob_CN_whole_genome_duplication
parameter_set$prob_CN_missegregation                  <- prob_CN_missegregation
parameter_set$prob_CN_chrom_arm_missegregation        <- prob_CN_chrom_arm_missegregation
parameter_set$prob_CN_focal_amplification             <- prob_CN_focal_amplification
parameter_set$prob_CN_focal_deletion                  <- prob_CN_focal_deletion
parameter_set$prob_CN_cnloh_interstitial              <- prob_CN_cnloh_interstitial
parameter_set$prob_CN_cnloh_terminal                  <- prob_CN_cnloh_terminal
parameter_set$prob_CN_focal_amplification_length      <- prob_CN_focal_amplification_length
parameter_set$prob_CN_focal_deletion_length           <- prob_CN_focal_deletion_length
parameter_set$prob_CN_cnloh_interstitial_length       <- prob_CN_cnloh_interstitial_length
parameter_set$prob_CN_cnloh_terminal_length           <- prob_CN_cnloh_terminal_length
parameter_set
vec_selection_rates                                   <- rep(0.05,nrow(driver_library))
rate_driver                                           <- 1e-16
prob_CN_whole_genome_duplication                      <- 1e-6
prob_CN_missegregation                                <- 1e-6
prob_CN_chrom_arm_missegregation                      <- 1e-6
prob_CN_focal_amplification                           <- 1e-6
prob_CN_focal_deletion                                <- 1e-6
prob_CN_cnloh_interstitial                            <- 1e-6
prob_CN_cnloh_terminal                                <- 1e-6
prob_CN_focal_amplification_length                    <- 0.1
prob_CN_focal_deletion_length                         <- 0.1
prob_CN_cnloh_interstitial_length                     <- 0.1
prob_CN_cnloh_terminal_length                         <- 0.1
parameter_set                                         <- list()
parameter_set$vec_selection_rates                     <- vec_selection_rates
parameter_set$rate_driver                             <- rate_driver
parameter_set$prob_CN_whole_genome_duplication        <- prob_CN_whole_genome_duplication
parameter_set$prob_CN_missegregation                  <- prob_CN_missegregation
parameter_set$prob_CN_chrom_arm_missegregation        <- prob_CN_chrom_arm_missegregation
parameter_set$prob_CN_focal_amplification             <- prob_CN_focal_amplification
parameter_set$prob_CN_focal_deletion                  <- prob_CN_focal_deletion
parameter_set$prob_CN_cnloh_interstitial              <- prob_CN_cnloh_interstitial
parameter_set$prob_CN_cnloh_terminal                  <- prob_CN_cnloh_terminal
parameter_set$prob_CN_focal_amplification_length      <- prob_CN_focal_amplification_length
parameter_set$prob_CN_focal_deletion_length           <- prob_CN_focal_deletion_length
parameter_set$prob_CN_cnloh_interstitial_length       <- prob_CN_cnloh_interstitial_length
parameter_set$prob_CN_cnloh_terminal_length           <- prob_CN_cnloh_terminal_length
SIMULATOR_VARIABLES_for_fitting <- function(model,parameter_set)
knitr::opts_chunk$set(
collapse = TRUE,
warning=FALSE, message=FALSE,
comment = "#>"
)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
SIMULATOR_VARIABLES_for_fitting <- function(model,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
vec_selection_rates                                   <- rep(0.05,nrow(driver_library))
rate_driver                                           <- 1e-16
prob_CN_whole_genome_duplication                      <- 1e-6
prob_CN_missegregation                                <- 1e-6
prob_CN_chrom_arm_missegregation                      <- 1e-6
prob_CN_focal_amplification                           <- 1e-6
prob_CN_focal_deletion                                <- 1e-6
prob_CN_cnloh_interstitial                            <- 1e-6
prob_CN_cnloh_terminal                                <- 1e-6
prob_CN_focal_amplification_length                    <- 0.1
prob_CN_focal_deletion_length                         <- 0.1
prob_CN_cnloh_interstitial_length                     <- 0.1
prob_CN_cnloh_terminal_length                         <- 0.1
parameter_set                                         <- list()
parameter_set$vec_selection_rates                     <- vec_selection_rates
parameter_set$rate_driver                             <- rate_driver
parameter_set$prob_CN_whole_genome_duplication        <- prob_CN_whole_genome_duplication
parameter_set$prob_CN_missegregation                  <- prob_CN_missegregation
parameter_set$prob_CN_chrom_arm_missegregation        <- prob_CN_chrom_arm_missegregation
parameter_set$prob_CN_focal_amplification             <- prob_CN_focal_amplification
parameter_set$prob_CN_focal_deletion                  <- prob_CN_focal_deletion
parameter_set$prob_CN_cnloh_interstitial              <- prob_CN_cnloh_interstitial
parameter_set$prob_CN_cnloh_terminal                  <- prob_CN_cnloh_terminal
parameter_set$prob_CN_focal_amplification_length      <- prob_CN_focal_amplification_length
parameter_set$prob_CN_focal_deletion_length           <- prob_CN_focal_deletion_length
parameter_set$prob_CN_cnloh_interstitial_length       <- prob_CN_cnloh_interstitial_length
parameter_set$prob_CN_cnloh_terminal_length           <- prob_CN_cnloh_terminal_length
SIMULATOR_VARIABLES_for_fitting <- function(model,parameter_set)
SIMULATOR_VARIABLES_for_fitting(model,parameter_set)
SIMULATOR_VARIABLES_for_fitting(MODEL,parameter_set)
driver_library
driver_library$Gene_role
driver_library$Gene_role=='TSG'
(driver_library$Gene_role=='TSG')["TRUE"]
driver_library$Gene_role=='TSG'
driver_library$Gene_role=='TSG'['TRUE']
sum(driver_library$Gene_role=='TSG')
sum(driver_library$Gene_role=='ONCOGENE')
count_TSG                           <- sum(driver_library$Gene_role=='TSG')
count_ONCOGENE                      <- sum(driver_library$Gene_role=='ONCOGENE')
count_TSG
count_ONCOGENE
which(driver_library$Gene_role=='TSG')
list_TSG                            <- which(driver_library$Gene_role=='TSG')
list_TSG
length(list_TSG)
driver_library
driver_library$Affected_donor_count[11]
driver_library$Affected_donor_count[11]=8
driver_library
driver_library$Affected_donor_count[11]=9
driver_library
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
SIMULATOR_VARIABLES_for_fitting(MODEL,parameter_set)
driver_library
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
SIMULATOR_VARIABLES_for_fitting(MODEL,parameter_set)
driver_library
1.186213/1.129726
SIMULATOR_VARIABLES_for_fitting(MODEL,parameter_set)
driver_library
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(model,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
a=matrix(1:15,nrow=3)
a
a=a[-2,]
a
isempty(a)
is.null(a)
a=c()
is.null(a)
a=matrix(1:15,nrow=3)
a=a[-1,]
a
a=a[-1,]
a
a=a[-1,]
a=matrix(1:15,nrow=3)
a=a[-c(1,2,3),]
a
is.null(a)
a
is.null(a)
a[,1]
a
is.na(a)
all(is.na(a))
a=matrix(1:15,nrow=3)
all(is.na(a))
driver_library
driver_library$Chromosome
driver_library$Chromosome[3]
which(driver_library$Chromosome==17)
a
a[1,]
aa=c("a","b","c")
aa
which(aa=="b")
driver_library
driver_library_test=driver_library
driver_library_test
driver_library_test=driver_library_test[-1:-10,]
driver_library_test
driver_library_test=driver_library_test[-1:-3,]
driver_library_test
driver_library_test$Gene_ID
driver_library_test$Gene_ID=="PPP2R1A"
driver_library[driver_library$Gene_ID==driver_library_test$Gene_ID]
driver_library$Gene_ID==driver_library_test$Gene_ID
which(driver_library$Gene_ID==driver_library_test$Gene_ID)
matrix(1:5,nrow=1)
a=matrix(1:5,nrow=1)
a[2,]=6:10
a
a[2,2]=1
a[2,]<-6:10
rbind(a,6:10)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
MODEL <- 'HGSOC-BULK'
SIMULATOR_VARIABLES_for_simulation(MODEL)
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
a=c(1,1,1,2,3)
unique(a)
driver_library
driver_library$extra=0
driver_library
driver_library$s_rate_MUT^driver_library$s_rate_WT
prod(driver_library$s_rate_MUT^driver_library$s_rate_WT)
a=1:10
b=1:10
a^b
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
ABC_one_simulation(MODEL,parameter_set)
a=0:4
a
a[a~=0]
a[a!=0]
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
devtools::install_github("dinhngockhanh/CancerSimulator")
library(ggplot2)
library(signals)
library(CancerSimulator)
devtools::load_all()
devtools::document()
ABC_one_simulation(MODEL,parameter_set)
